<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">

<title>Attributes and Class</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="attributes_and_class_files/libs/clipboard/clipboard.min.js"></script>
<script src="attributes_and_class_files/libs/quarto-html/quarto.js"></script>
<script src="attributes_and_class_files/libs/quarto-html/popper.min.js"></script>
<script src="attributes_and_class_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="attributes_and_class_files/libs/quarto-html/anchor.min.js"></script>
<link href="attributes_and_class_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="attributes_and_class_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="attributes_and_class_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="attributes_and_class_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="attributes_and_class_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#libraries-we-will-use" id="toc-libraries-we-will-use" class="nav-link" data-scroll-target="#libraries-we-will-use"><span class="header-section-number">1.1</span> Libraries we will use</a></li>
  <li><a href="#dataset-we-will-use" id="toc-dataset-we-will-use" class="nav-link" data-scroll-target="#dataset-we-will-use"><span class="header-section-number">1.2</span> Dataset we will use</a></li>
  </ul></li>
  <li><a href="#attributes-and-augmented-vectors" id="toc-attributes-and-augmented-vectors" class="nav-link" data-scroll-target="#attributes-and-augmented-vectors"><span class="header-section-number">2</span> Attributes and augmented vectors</a>
  <ul class="collapse">
  <li><a href="#review-data-structures-vectors" id="toc-review-data-structures-vectors" class="nav-link" data-scroll-target="#review-data-structures-vectors"><span class="header-section-number">2.1</span> Review data structures: Vectors</a>
  <ul class="collapse">
  <li><a href="#atomic-vectors" id="toc-atomic-vectors" class="nav-link" data-scroll-target="#atomic-vectors"><span class="header-section-number">2.1.1</span> Atomic vectors</a></li>
  <li><a href="#lists" id="toc-lists" class="nav-link" data-scroll-target="#lists"><span class="header-section-number">2.1.2</span> Lists</a></li>
  <li><a href="#data-frames" id="toc-data-frames" class="nav-link" data-scroll-target="#data-frames"><span class="header-section-number">2.1.3</span> Data frames</a></li>
  </ul></li>
  <li><a href="#atomic-vectors-versus-augmented-vectors" id="toc-atomic-vectors-versus-augmented-vectors" class="nav-link" data-scroll-target="#atomic-vectors-versus-augmented-vectors"><span class="header-section-number">2.2</span> Atomic vectors versus augmented vectors</a></li>
  <li><a href="#attributes-and-functions-to-identifymodify-attributes" id="toc-attributes-and-functions-to-identifymodify-attributes" class="nav-link" data-scroll-target="#attributes-and-functions-to-identifymodify-attributes"><span class="header-section-number">2.3</span> Attributes and functions to identify/modify attributes</a>
  <ul class="collapse">
  <li><a href="#describe-all-attributes-of-an-object" id="toc-describe-all-attributes-of-an-object" class="nav-link" data-scroll-target="#describe-all-attributes-of-an-object"><span class="header-section-number">2.3.1</span> Describe all attributes of an object</a></li>
  <li><a href="#attributes-of-a-variable-in-a-data-frame" id="toc-attributes-of-a-variable-in-a-data-frame" class="nav-link" data-scroll-target="#attributes-of-a-variable-in-a-data-frame"><span class="header-section-number">2.3.2</span> Attributes of a variable in a data frame</a></li>
  <li><a href="#attributes-of-lists-and-data-frames" id="toc-attributes-of-lists-and-data-frames" class="nav-link" data-scroll-target="#attributes-of-lists-and-data-frames"><span class="header-section-number">2.3.3</span> Attributes of lists and data frames</a></li>
  <li><a href="#attr-function-to-get-or-set-specific-attributes-of-an-object" id="toc-attr-function-to-get-or-set-specific-attributes-of-an-object" class="nav-link" data-scroll-target="#attr-function-to-get-or-set-specific-attributes-of-an-object"><span class="header-section-number">2.3.4</span> attr() function to get or set specific attributes of an object</a></li>
  <li><a href="#attr-function-on-data-frames" id="toc-attr-function-on-data-frames" class="nav-link" data-scroll-target="#attr-function-on-data-frames"><span class="header-section-number">2.3.5</span> attr() function on data frames</a></li>
  <li><a href="#why-add-attributes-to-data-frame-or-variables-of-data-frame" id="toc-why-add-attributes-to-data-frame-or-variables-of-data-frame" class="nav-link" data-scroll-target="#why-add-attributes-to-data-frame-or-variables-of-data-frame"><span class="header-section-number">2.3.6</span> Why add attributes to data frame or variables of data frame?</a></li>
  <li><a href="#student-exercise" id="toc-student-exercise" class="nav-link" data-scroll-target="#student-exercise"><span class="header-section-number">2.3.7</span> Student exercise</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#object-class" id="toc-object-class" class="nav-link" data-scroll-target="#object-class"><span class="header-section-number">3</span> Object class</a>
  <ul class="collapse">
  <li><a href="#why-is-object-class-important" id="toc-why-is-object-class-important" class="nav-link" data-scroll-target="#why-is-object-class-important"><span class="header-section-number">3.1</span> Why is object class important?</a>
  <ul class="collapse">
  <li><a href="#class-and-object-oriented-programming" id="toc-class-and-object-oriented-programming" class="nav-link" data-scroll-target="#class-and-object-oriented-programming"><span class="header-section-number">3.1.1</span> Class and object-oriented programming</a></li>
  <li><a href="#functions-care-about-object-class-not-object-type" id="toc-functions-care-about-object-class-not-object-type" class="nav-link" data-scroll-target="#functions-care-about-object-class-not-object-type"><span class="header-section-number">3.1.2</span> Functions care about object <strong>class</strong>, not object <strong>type</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#class-factor" id="toc-class-factor" class="nav-link" data-scroll-target="#class-factor"><span class="header-section-number">4</span> Class == factor</a>
  <ul class="collapse">
  <li><a href="#factors" id="toc-factors" class="nav-link" data-scroll-target="#factors"><span class="header-section-number">4.1</span> Factors</a></li>
  <li><a href="#working-with-factor-variables" id="toc-working-with-factor-variables" class="nav-link" data-scroll-target="#working-with-factor-variables"><span class="header-section-number">4.2</span> Working with factor variables</a></li>
  <li><a href="#how-to-identify-the-variable-values-associated-with-factor-levels" id="toc-how-to-identify-the-variable-values-associated-with-factor-levels" class="nav-link" data-scroll-target="#how-to-identify-the-variable-values-associated-with-factor-levels"><span class="header-section-number">4.3</span> How to identify the variable values associated with factor levels</a>
  <ul class="collapse">
  <li><a href="#student-exercise-working-with-factors" id="toc-student-exercise-working-with-factors" class="nav-link" data-scroll-target="#student-exercise-working-with-factors"><span class="header-section-number">4.3.1</span> Student exercise working with factors</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#class-labelled" id="toc-class-labelled" class="nav-link" data-scroll-target="#class-labelled"><span class="header-section-number">5</span> Class == labelled</a>
  <ul class="collapse">
  <li><a href="#data-we-will-use-to-introduce-labelled-class" id="toc-data-we-will-use-to-introduce-labelled-class" class="nav-link" data-scroll-target="#data-we-will-use-to-introduce-labelled-class"><span class="header-section-number">5.1</span> Data we will use to introduce <code>labelled</code> class</a></li>
  <li><a href="#using-haven-package-to-read-sasspssstata-datasets-into-r" id="toc-using-haven-package-to-read-sasspssstata-datasets-into-r" class="nav-link" data-scroll-target="#using-haven-package-to-read-sasspssstata-datasets-into-r"><span class="header-section-number">5.2</span> Using <code>haven</code> package to read SAS/SPSS/Stata datasets into R</a></li>
  <li><a href="#what-is-object-class-labelled" id="toc-what-is-object-class-labelled" class="nav-link" data-scroll-target="#what-is-object-class-labelled"><span class="header-section-number">5.3</span> What is object class = <code>labelled</code>?</a></li>
  <li><a href="#labelled-package" id="toc-labelled-package" class="nav-link" data-scroll-target="#labelled-package"><span class="header-section-number">5.4</span> <code>labelled</code> package</a></li>
  <li><a href="#get-variable-and-value-labels" id="toc-get-variable-and-value-labels" class="nav-link" data-scroll-target="#get-variable-and-value-labels"><span class="header-section-number">5.5</span> Get variable and value labels</a></li>
  <li><a href="#working-with-labelled-class-data" id="toc-working-with-labelled-class-data" class="nav-link" data-scroll-target="#working-with-labelled-class-data"><span class="header-section-number">5.6</span> Working with <code>labelled</code> class data</a></li>
  <li><a href="#set-variable-and-value-labels" id="toc-set-variable-and-value-labels" class="nav-link" data-scroll-target="#set-variable-and-value-labels"><span class="header-section-number">5.7</span> Set variable and value labels</a>
  <ul class="collapse">
  <li><a href="#create-example-data-frame" id="toc-create-example-data-frame" class="nav-link" data-scroll-target="#create-example-data-frame"><span class="header-section-number">5.7.1</span> Create example data frame</a></li>
  <li><a href="#set-variable-labels" id="toc-set-variable-labels" class="nav-link" data-scroll-target="#set-variable-labels"><span class="header-section-number">5.7.2</span> Set variable labels</a></li>
  <li><a href="#set-value-labels" id="toc-set-value-labels" class="nav-link" data-scroll-target="#set-value-labels"><span class="header-section-number">5.7.3</span> Set value labels</a></li>
  <li><a href="#view-the-set-variable-and-value-labels" id="toc-view-the-set-variable-and-value-labels" class="nav-link" data-scroll-target="#view-the-set-variable-and-value-labels"><span class="header-section-number">5.7.4</span> View the set variable and value labels</a></li>
  <li><a href="#labelled-student-exercise" id="toc-labelled-student-exercise" class="nav-link" data-scroll-target="#labelled-student-exercise"><span class="header-section-number">5.7.5</span> <code>labelled</code> student exercise</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comparing-class-labelled-to-class-factor" id="toc-comparing-class-labelled-to-class-factor" class="nav-link" data-scroll-target="#comparing-class-labelled-to-class-factor"><span class="header-section-number">6</span> Comparing class labelled to class factor</a>
  <ul class="collapse">
  <li><a href="#why-factor-variables-are-essential-for-analysis" id="toc-why-factor-variables-are-essential-for-analysis" class="nav-link" data-scroll-target="#why-factor-variables-are-essential-for-analysis"><span class="header-section-number">6.0.1</span> Why factor variables are essential for analysis</a></li>
  <li><a href="#converting-classlabelled-to-classfactor" id="toc-converting-classlabelled-to-classfactor" class="nav-link" data-scroll-target="#converting-classlabelled-to-classfactor"><span class="header-section-number">6.1</span> Converting <code>class==labelled</code> to <code>class==factor</code></a></li>
  <li><a href="#working-with-classfactor-data" id="toc-working-with-classfactor-data" class="nav-link" data-scroll-target="#working-with-classfactor-data"><span class="header-section-number">6.2</span> Working with <code>class==factor</code> data</a></li>
  </ul></li>
  <li><a href="#appendix-creating-factor-variables" id="toc-appendix-creating-factor-variables" class="nav-link" data-scroll-target="#appendix-creating-factor-variables"><span class="header-section-number">7</span> Appendix: Creating factor variables</a>
  <ul class="collapse">
  <li><a href="#create-factors-from-string-variables" id="toc-create-factors-from-string-variables" class="nav-link" data-scroll-target="#create-factors-from-string-variables"><span class="header-section-number">7.1</span> Create factors [from string variables]</a></li>
  <li><a href="#creating-factors-from-integer-vectors" id="toc-creating-factors-from-integer-vectors" class="nav-link" data-scroll-target="#creating-factors-from-integer-vectors"><span class="header-section-number">7.2</span> Creating factors [from integer vectors]</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Attributes and Class</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<section id="libraries-we-will-use" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="libraries-we-will-use"><span class="header-section-number">1.1</span> Libraries we will use</h2>
<p><strong>Load the packages</strong> we will use by running this code chunk:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>If package not yet installed</strong>, then must install before you load. Install in “console” rather than .Rmd file:</p>
<ul>
<li>Generic syntax: <code>install.packages("package_name")</code></li>
<li>Install “tidyverse”: <code>install.packages("tidyverse")</code></li>
</ul>
<p><strong>Note</strong>: When we load package, name of package is not in quotes; but when we install package, name of package is in quotes:</p>
<ul>
<li><code>install.packages("tidyverse")</code></li>
<li><code>library(tidyverse)</code></li>
</ul>
</section>
<section id="dataset-we-will-use" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="dataset-we-will-use"><span class="header-section-number">1.2</span> Dataset we will use</h2>
<p>Recall from Into the tidyverse lecture, we used the data set <code>wwlist</code>. This data set represents “prospects” purchased by Western Washington U.</p>
<ul>
<li>Essentially, universities identify/target “prospect” by buying student lists from College Board/ACT (e.g., $.50+ per prospect).<br>
</li>
<li>Data universities purchase on students includes their contact info (e.g., address, email), academics (e.g., GPA, AP coursework), socioeconomic and demographic characteristics.<br>
</li>
<li>Universities choose which prospective students’ information to purchase by filtering on criteria like their zip code, GPA, test score range, etc.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># remove all objects</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://github.com/anyone-can-cook/rclass1/raw/master/data/prospect_list/wwlist_merged.RData"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="attributes-and-augmented-vectors" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Attributes and augmented vectors</h1>
<section id="review-data-structures-vectors" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="review-data-structures-vectors"><span class="header-section-number">2.1</span> Review data structures: Vectors</h2>
<p><strong>Two types of vectors:</strong></p>
<ol type="1">
<li><strong>Atomic vectors</strong></li>
<li><strong>Lists</strong></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-structures-overview.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Overview of data structures (Grolemund and Wickham, 2018)</figcaption>
</figure>
</div>
<section id="atomic-vectors" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="atomic-vectors"><span class="header-section-number">2.1.1</span> Atomic vectors</h3>
<p>An <strong>atomic vector</strong> is a collection of values</p>
<ul>
<li>Each value in an atomic vector is an <strong>element</strong></li>
<li>All elements within vector must have the same <strong>data type</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co"># parentheses () assign and print object in one step</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(a) <span class="co"># length = number of elements</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(a) <span class="co"># numeric atomic vector, type=double</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(a) <span class="co"># investigate structure of object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:3] 1 2 3</code></pre>
</div>
</div>
<p>Can assign <strong>names</strong> to vector elements, creating a <strong>named atomic vector</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">v1=</span><span class="dv">1</span>,<span class="at">v2=</span><span class="dv">2</span>,<span class="at">v3=</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>v1 v2 v3 
 1  2  3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(b) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(b) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(b) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Named num [1:3] 1 2 3
 - attr(*, "names")= chr [1:3] "v1" "v2" "v3"</code></pre>
</div>
</div>
</section>
<section id="lists" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="lists"><span class="header-section-number">2.1.2</span> Lists</h3>
<ul>
<li>Like atomic vectors, <strong>lists</strong> are objects that contain <strong>elements</strong></li>
<li>However, <strong>data type</strong> can differ across elements within a list
<ul>
<li>E.g., an element of a list can be another list</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>list_a <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="st">"apple"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(list_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(list_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(list_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 3
 $ : num 1
 $ : num 2
 $ : chr "apple"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>list_b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="fu">c</span>(<span class="st">"apple"</span>, <span class="st">"orange"</span>), <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(list_b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(list_b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 3
 $ : num 1
 $ : chr [1:2] "apple" "orange"
 $ :List of 2
  ..$ : num 1
  ..$ : num 2</code></pre>
</div>
</div>
<p>Like atomic vectors, elements within a list can be named, thereby creating a <strong>named list</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># not named</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(list_b) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 3
 $ : num 1
 $ : chr [1:2] "apple" "orange"
 $ :List of 2
  ..$ : num 1
  ..$ : num 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># named</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>list_c <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">v1=</span><span class="dv">1</span>, <span class="at">v2=</span><span class="fu">c</span>(<span class="st">"apple"</span>, <span class="st">"orange"</span>), <span class="at">v3=</span><span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(list_c) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 3
 $ v1: num 1
 $ v2: chr [1:2] "apple" "orange"
 $ v3:List of 3
  ..$ : num 1
  ..$ : num 2
  ..$ : num 3</code></pre>
</div>
</div>
</section>
<section id="data-frames" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="data-frames"><span class="header-section-number">2.1.3</span> Data frames</h3>
<p>A <strong>data frame</strong> is a list with the following characteristics:</p>
<ul>
<li>All the elements must be <strong>vectors</strong> with the same <strong>length</strong></li>
<li>Data frames are <strong>augmented lists</strong> because they have additional <strong>attributes</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a regular list</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>(list_d <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">col_a =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">col_b =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="at">col_c =</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$col_a
[1] 1 2 3

$col_b
[1] 4 5 6

$col_c
[1] 7 8 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(list_d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(list_d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "col_a" "col_b" "col_c"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a data frame</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>(df_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col_a =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">col_b =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="at">col_c =</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col_a col_b col_c
1     1     4     7
2     2     5     8
3     3     6     9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(df_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(df_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "col_a" "col_b" "col_c"

$class
[1] "data.frame"

$row.names
[1] 1 2 3</code></pre>
</div>
</div>
</section>
</section>
<section id="atomic-vectors-versus-augmented-vectors" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="atomic-vectors-versus-augmented-vectors"><span class="header-section-number">2.2</span> Atomic vectors versus augmented vectors</h2>
<p><strong>Atomic vectors</strong> [our focus so far]</p>
<ul>
<li>I think of atomic vectors as “just the data”</li>
<li>Atomic vectors are the building blocks for augmented vectors</li>
</ul>
<p><strong>Augmented vectors</strong></p>
<ul>
<li><strong>Augmented vectors</strong> are atomic vectors with additional <strong>attributes</strong> attached</li>
</ul>
<p><strong>Attributes</strong></p>
<ul>
<li><strong>Attributes</strong> are additional “metadata” that can be attached to any object (e.g., vector or list)</li>
</ul>
<p>Example: Variables of a dataset</p>
<ul>
<li>A data frame is a list</li>
<li>Each element in the list is a variable, which consists of:
<ul>
<li>Atomic vector (“just the data”)</li>
<li>Any attributes we want to attach to each element/variable</li>
</ul></li>
<li>Variable <strong>name</strong>, an attribute of the data frame object</li>
</ul>
<p>Other examples of attributes in R</p>
<ul>
<li>Value <strong>labels</strong>: Character labels (e.g., “Charter School”) attached to numeric values</li>
<li>Object <strong>class</strong>: Specifies how object is treated by object oriented programming language</li>
</ul>
<p><strong>Main takeaway</strong>:</p>
<ul>
<li><strong>Augmented vectors</strong> are <strong>atomic vectors</strong> (just the data) with additional <strong>attributes</strong> attached</li>
</ul>
</section>
<section id="attributes-and-functions-to-identifymodify-attributes" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="attributes-and-functions-to-identifymodify-attributes"><span class="header-section-number">2.3</span> Attributes and functions to identify/modify attributes</h2>
<p>Description of attributes from Grolemund and Wickham 20.6</p>
<ul>
<li>“Any vector can contain arbitrary additional <strong>metadata</strong> through its <strong>attributes</strong>”</li>
<li>“You can think of <strong>attributes</strong> as named list of vectors that can be attached to any object”</li>
</ul>
<p>Functions to identify and modify attributes</p>
<ul>
<li><code>attributes()</code> function to describe all attributes of an object</li>
<li><code>attr()</code> to see individual attribute of an object or set/change an individual attribute of an object</li>
</ul>
<section id="describe-all-attributes-of-an-object" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="describe-all-attributes-of-an-object"><span class="header-section-number">2.3.1</span> Describe all attributes of an object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pull up help file for the attributes() function</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>?attributes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Attributes of a <strong>named atomic vector</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create named atomic vector</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>(vector1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">c =</span> <span class="dv">3</span>, <span class="at">d =</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a b c d 
1 2 3 4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(vector1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "a" "b" "c" "d"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(vector1) <span class="sc">%&gt;%</span> <span class="fu">str</span>() <span class="co"># a named list of vectors!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 1
 $ names: chr [1:4] "a" "b" "c" "d"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all attributes from the object</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(vector1) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>vector1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(vector1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
</section>
<section id="attributes-of-a-variable-in-a-data-frame" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="attributes-of-a-variable-in-a-data-frame"><span class="header-section-number">2.3.2</span> Attributes of a variable in a data frame</h3>
<p><strong>Accessing variable using <code>[[]]</code> subset operator</strong></p>
<ul>
<li>Recall <code>object_name[["element_name"]]</code> accesses contents of the element</li>
<li>If object is a data frame, <code>df_name[["var_name"]]</code> accesses contents of variable
<ul>
<li>For simple vars like <code>firstgen</code>, syntax yields an atomic vector (“just the data”)</li>
</ul></li>
<li>Shorthand syntax for <code>df_name[["var_name"]]</code> is <code>df_name$var_name</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist[[<span class="st">"firstgen"</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:268396] NA "N" "N" "N" NA "N" "N" "Y" "Y" "N" "N" "N" "N" "N" "N" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist[[<span class="st">"firstgen"</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>firstgen) <span class="co"># same same</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:268396] NA "N" "N" "N" NA "N" "N" "Y" "Y" "N" "N" "N" "N" "N" "N" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist<span class="sc">$</span>firstgen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<p><strong>Accessing variable using <code>[]</code> subset operator</strong></p>
<ul>
<li><code>object_name["element_name"]</code> creates object of same type as <code>object_name</code></li>
<li>If object is a data frame, <code>df_name["var_name"]</code> returns a data frame containing just the <code>var_name</code> column</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist[<span class="st">"firstgen"</span>])</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist[<span class="st">"firstgen"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="attributes-of-lists-and-data-frames" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="attributes-of-lists-and-data-frames"><span class="header-section-number">2.3.3</span> Attributes of lists and data frames</h3>
<p>Attributes of a <strong>named list</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>list2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">col_a =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">col_b =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(list2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 2
 $ col_a: num [1:3] 1 2 3
 $ col_b: num [1:3] 4 5 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(list2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "col_a" "col_b"</code></pre>
</div>
</div>
<p>Note that the <code>names</code> attribute is an attribute of the list, not an attribute of the elements within the list (which are atomic vectors)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>list2[[<span class="st">'col_a'</span>]] <span class="co"># the element named 'col_a'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(list2[[<span class="st">'col_a'</span>]]) <span class="co"># structure of the element named 'col_a'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:3] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(list2[[<span class="st">'col_a'</span>]]) <span class="co"># attributes of element named 'col_a'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<p>Attributes of a <strong>data frame</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>list3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col_a =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">col_b =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(list3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3 obs. of  2 variables:
 $ col_a: num  1 2 3
 $ col_b: num  4 5 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(list3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "col_a" "col_b"

$class
[1] "data.frame"

$row.names
[1] 1 2 3</code></pre>
</div>
</div>
<p>Note: attributes <code>names</code>, <code>class</code> and <code>row.names</code> are attributes of the data frame</p>
<ul>
<li>they are not attributes of the elements (variables) within the data frame, which are atomic vectors (i.e., just the data)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(list3[[<span class="st">'col_a'</span>]]) <span class="co"># structure of the element named 'col_a'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:3] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(list3[[<span class="st">'col_a'</span>]]) <span class="co"># attributes of element named 'col_a'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
</section>
<section id="attr-function-to-get-or-set-specific-attributes-of-an-object" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="attr-function-to-get-or-set-specific-attributes-of-an-object"><span class="header-section-number">2.3.4</span> attr() function to get or set specific attributes of an object</h3>
<p>Syntax</p>
<ul>
<li>Get: <code>attr(x, which, exact = FALSE)</code></li>
<li>Set: <code>attr(x, which) &lt;- value</code></li>
</ul>
<p>Arguments</p>
<ul>
<li><code>x</code>: an object whose attributes are to be accessed</li>
<li><code>which</code>: a non-empty character string specifying which attribute is to be accessed</li>
<li><code>exact</code> (logical): should <code>which</code> be matched exactly? default is <code>exact = FALSE</code></li>
<li><code>value</code>: an object, new value of attribute, or <code>NULL</code> to remove attribute</li>
</ul>
<p><strong>Using <code>attr()</code> to get specific attribute of an object</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>vector1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b=</span> <span class="dv">2</span>, <span class="at">c=</span> <span class="dv">3</span>, <span class="at">d =</span> <span class="dv">4</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(vector1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "a" "b" "c" "d"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(<span class="at">x=</span>vector1, <span class="at">which =</span> <span class="st">"names"</span>, <span class="at">exact =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "c" "d"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(vector1, <span class="st">"names"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "c" "d"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(vector1, <span class="st">"name"</span>) <span class="co"># we don't provide exact name of attribute</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "c" "d"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(vector1, <span class="st">"name"</span>, <span class="at">exact =</span> <span class="cn">TRUE</span>) <span class="co"># don't provide exact name of attribute</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<p><strong>Using <code>attr()</code> to set specific attribute of an object</strong> (output omitted)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>(vector1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b=</span> <span class="dv">2</span>, <span class="at">c=</span> <span class="dv">3</span>, <span class="at">d =</span> <span class="dv">4</span>))</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(vector1) <span class="co"># see all attributes</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(<span class="at">x=</span>vector1, <span class="at">which =</span> <span class="st">"greeting"</span>) <span class="ot">&lt;-</span> <span class="st">"Hi!"</span> <span class="co"># create new attribute</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(<span class="at">x=</span>vector1, <span class="at">which =</span> <span class="st">"greeting"</span>) <span class="co"># see attribute</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(vector1, <span class="st">"farewell"</span>) <span class="ot">&lt;-</span> <span class="st">"Bye!"</span> <span class="co"># create attribute</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(<span class="at">x=</span>vector1, <span class="at">which =</span> <span class="st">"names"</span>) <span class="co"># see names attribute</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(<span class="at">x=</span>vector1, <span class="at">which =</span> <span class="st">"names"</span>) <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># delete names attribute</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(vector1) <span class="co"># see all attributes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="attr-function-on-data-frames" class="level3" data-number="2.3.5">
<h3 data-number="2.3.5" class="anchored" data-anchor-id="attr-function-on-data-frames"><span class="header-section-number">2.3.5</span> attr() function on data frames</h3>
<p><strong>Using <code>wwlist</code>, create data frame with three variables</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>wwlist_small <span class="ot">&lt;-</span> wwlist[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, ] <span class="sc">%&gt;%</span> <span class="fu">select</span>(hs_state,firstgen,med_inc_zip)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist_small)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist_small)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist_small) <span class="sc">%&gt;%</span> <span class="fu">str</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Get/set attribute of a data frame</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get/examine names attribute</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(<span class="at">x=</span>wwlist_small, <span class="at">which =</span> <span class="st">"names"</span>) </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">attr</span>(<span class="at">x=</span>wwlist_small, <span class="at">which =</span> <span class="st">"names"</span>)) <span class="co"># names attribute is character atomic vector, length=3</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co">#add new attribute to data frame</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(<span class="at">x=</span>wwlist_small, <span class="at">which =</span> <span class="st">"new_attribute"</span>) <span class="ot">&lt;-</span> <span class="st">"contents of new attribute"</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist_small)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Get/set attribute of a variable in data frame</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist_small<span class="sc">$</span>med_inc_zip)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist_small<span class="sc">$</span>med_inc_zip)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co">#create attribute for variable med_inc_zip</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(wwlist_small<span class="sc">$</span>med_inc_zip, <span class="st">"inc attribute"</span>) <span class="ot">&lt;-</span> <span class="st">"inc attribute contents"</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">#investigate attribute for variable med_inc_zip</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist_small<span class="sc">$</span>med_inc_zip)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist_small<span class="sc">$</span>med_inc_zip)</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(wwlist_small<span class="sc">$</span>med_inc_zip, <span class="st">"inc attribute"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="why-add-attributes-to-data-frame-or-variables-of-data-frame" class="level3" data-number="2.3.6">
<h3 data-number="2.3.6" class="anchored" data-anchor-id="why-add-attributes-to-data-frame-or-variables-of-data-frame"><span class="header-section-number">2.3.6</span> Why add attributes to data frame or variables of data frame?</h3>
<p>Pedagogical reasons</p>
<ul>
<li>Important to know how you can apply <code>attributes()</code> and <code>attr()</code> to data frames and to variables within data frames</li>
</ul>
<p>Example practical application: interactive dashboards</p>
<ul>
<li>When creating “dashboard” you might want to add “tooltips”
<ul>
<li>“Tooltip” is a message that appears when cursor is positioned over an icon</li>
<li>The text in the tooltip is the contents of an attribute</li>
</ul></li>
<li>Example dashboard: <a href="https://jkcf.shinyapps.io/dashboard/">LINK</a></li>
</ul>
</section>
<section id="student-exercise" class="level3" data-number="2.3.7">
<h3 data-number="2.3.7" class="anchored" data-anchor-id="student-exercise"><span class="header-section-number">2.3.7</span> Student exercise</h3>
<ol type="1">
<li><p>Using <code>wwlist</code>, create data frame of 30 observations with three variables: <code>state</code>, <code>zip5</code>, <code>pop_total_zip</code></p></li>
<li><p>Return all attributes of this new data frame using <code>attributes()</code>. Then, get the <code>names</code> attribute of the data frame using <code>attr()</code>.</p></li>
<li><p>Add a new attribute to the data frame called <code>attribute_data</code> whose content is <code>"new attribute of data"</code>. Then, return all attributes of the data frame as well as get the value of the newly created <code>attribute_data</code>.</p></li>
<li><p>Return the attributes of the variable <code>pop_total_zip</code> in the data frame.</p></li>
<li><p>Add a new attribute to the variable <code>pop_total_zip</code> called <code>attribute_variable</code> whose content is <code>"new attribute of variable"</code>. Then, return all attributes of the variable as well as get the value of the newly created <code>attribute_variable</code>.</p></li>
</ol>
<details>
<summary>
<strong>Solutions to student exercise</strong>
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 1</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>wwlist_exercise <span class="ot">&lt;-</span> wwlist[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, ] <span class="sc">%&gt;%</span> <span class="fu">select</span>(state, zip5, pop_total_zip)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 2</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist_exercise)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(<span class="at">x=</span>wwlist_exercise, <span class="at">which =</span> <span class="st">"names"</span>) </span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 3</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(<span class="at">x=</span>wwlist_exercise, <span class="at">which =</span> <span class="st">"attribute_data"</span>) <span class="ot">&lt;-</span> <span class="st">"new attribute of data"</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist_exercise)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(wwlist_exercise, <span class="at">which =</span><span class="st">"attribute_data"</span>)</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 4</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist_exercise<span class="sc">$</span>pop_total_zip)</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 5</span></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(wwlist_exercise<span class="sc">$</span>pop_total_zip, <span class="st">"attribute_variable"</span>) <span class="ot">&lt;-</span> <span class="st">"new attribute of variable"</span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist_exercise<span class="sc">$</span>pop_total_zip)</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(wwlist_exercise<span class="sc">$</span>pop_total_zip, <span class="st">"attribute_variable"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p><br></p>
</section>
</section>
</section>
<section id="object-class" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Object class</h1>
<p>Every object in R has a <strong>class</strong></p>
<ul>
<li>Class is an <strong>attribute</strong> of an object</li>
<li>Object class controls how functions work and defines the rules for how objects can be treated by object oriented programming language
<ul>
<li>E.g., which functions you can apply to object of a particular class</li>
<li>E.g., what the function does to one object class, what it does to another object class</li>
</ul></li>
</ul>
<p>You can use the <code>class()</code> function to identify object class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>(vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b=</span> <span class="dv">2</span>, <span class="at">c=</span> <span class="dv">3</span>, <span class="at">d =</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a b c d 
1 2 3 4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(vector2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(vector2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div>
<p>When I encounter a new object I often investigate object by applying <code>typeof()</code>, <code>class()</code>, and <code>attributes()</code> functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(vector2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(vector2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(vector2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "a" "b" "c" "d"</code></pre>
</div>
</div>
<section id="why-is-object-class-important" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="why-is-object-class-important"><span class="header-section-number">3.1</span> Why is object class important?</h2>
<p>Specific functions usually work with only particular <strong>classes</strong> of objects</p>
<ul>
<li>“Date” functions usually only work on objects with a date class</li>
<li>“String” functions usually only work on objects with a character class</li>
<li>Functions that do mathematical computation usually work on objects with a numeric class</li>
</ul>
<section id="class-and-object-oriented-programming" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="class-and-object-oriented-programming"><span class="header-section-number">3.1.1</span> Class and object-oriented programming</h3>
<p>R is an object-oriented programming language</p>
<p>Definition of object oriented programming from this <a href="https://www.webopedia.com/TERM/O/object_oriented_programming_OOP.html">LINK</a></p>
<blockquote class="blockquote">
<p>“Object-oriented programming (OOP) refers to a type of computer programming in which programmers define not only the data type of a data structure, but also the types of operations (functions) that can be applied to the data structure.”</p>
</blockquote>
<p>Object <strong>class</strong> is fundamental to object oriented programming because:</p>
<ul>
<li>Object class determines which functions can be applied to the object</li>
<li>Object class also determines what those functions do to the object
<ul>
<li>E.g., a specific function might do one thing to objects of <strong>class</strong> A and another thing to objects of <strong>class</strong> B</li>
<li>What a function does to objects of different class is determined by whoever wrote the function</li>
</ul></li>
</ul>
<p>Many different object classes exist in R</p>
<ul>
<li>You can also create your own classes
<ul>
<li>Example: the <code>labelled</code> class is an object class created by Hadley Wickham when he created the <code>haven</code> package</li>
</ul></li>
<li>In this course we will work with classes that have been created by others</li>
</ul>
</section>
<section id="functions-care-about-object-class-not-object-type" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="functions-care-about-object-class-not-object-type"><span class="header-section-number">3.1.2</span> Functions care about object <strong>class</strong>, not object <strong>type</strong></h3>
<p><strong>Example</strong>: <code>sum()</code> applies to <strong>numeric</strong>, <strong>logical</strong>, or <strong>complex</strong> class objects</p>
<p>Apply <code>sum()</code> to object with class = <strong>logical</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">NA</span>, <span class="cn">TRUE</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>Apply <code>sum()</code> to object with class = <strong>numeric</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(wwlist<span class="sc">$</span>med_inc_zip) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wwlist<span class="sc">$</span>med_inc_zip) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>wwlist<span class="sc">$</span>med_inc_zip[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 92320.5 63653.0 88344.5 88408.5 82895.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(wwlist<span class="sc">$</span>med_inc_zip[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 415621.5</code></pre>
</div>
</div>
<p>What happens when we try to apply <code>sum()</code> to an object with class = <strong>character</strong>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(wwlist<span class="sc">$</span>hs_city)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wwlist<span class="sc">$</span>hs_city)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>wwlist<span class="sc">$</span>hs_city[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(wwlist<span class="sc">$</span>hs_city[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Example</strong>: <code>year()</code> from <code>lubridate</code> package applies to date-time objects</p>
<p>Apply <code>year()</code> to object with class = <strong>Date</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>wwlist<span class="sc">$</span>receive_date[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2016-05-31" "2016-05-31" "2016-05-31" "2016-05-31" "2016-05-31"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(wwlist<span class="sc">$</span>receive_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wwlist<span class="sc">$</span>receive_date) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Date"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">year</span>(wwlist<span class="sc">$</span>receive_date[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2016 2016 2016 2016 2016</code></pre>
</div>
</div>
<p>What happens when we try to apply <code>year()</code> to an object with class = <strong>numeric</strong>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(wwlist<span class="sc">$</span>med_inc_zip) </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wwlist<span class="sc">$</span>med_inc_zip) </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="fu">year</span>(wwlist<span class="sc">$</span>med_inc_zip[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Example</strong>: <code>tolower()</code> applies to <strong>character</strong> class objects</p>
<ul>
<li>Syntax: <code>tolower(x)</code></li>
<li><code>x</code> is “a character vector, or an object that can be coerced to character by <code>as.character()</code>”</li>
</ul>
<p>Most string functions are intended to apply to objects with a <strong>character</strong> class</p>
<ul>
<li><strong>type</strong> = character</li>
<li><strong>class</strong> = character</li>
</ul>
<p>Apply <code>tolower()</code> to object with class = <strong>character</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>hs_city)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:268396] "Seattle" "Covington" "Everett" "Seattle" "Lake Stevens" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(wwlist<span class="sc">$</span>hs_city)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wwlist<span class="sc">$</span>hs_city)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>wwlist<span class="sc">$</span>hs_city[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Seattle"      "Covington"    "Everett"      "Seattle"      "Lake Stevens"
[6] "Seattle"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tolower</span>(wwlist<span class="sc">$</span>hs_city[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "seattle"      "covington"    "everett"      "seattle"      "lake stevens"
[6] "seattle"     </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="class-factor" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Class == factor</h1>
<p><strong>Recoding variable <code>ethn_code</code> from data frame <code>wwlist</code></strong></p>
<p>Let’s first recode the <code>ethn_code</code> variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>wwlist <span class="ot">&lt;-</span> wwlist <span class="sc">%&gt;%</span>  </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ethn_code =</span> </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">recode</span>(ethn_code,</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">"american indian or alaska native"</span> <span class="ot">=</span> <span class="st">"nativeam"</span>,</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"asian or native hawaiian or other pacific islander"</span> <span class="ot">=</span> <span class="st">"api"</span>,</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"black or african american"</span> <span class="ot">=</span> <span class="st">"black"</span>,</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cuban"</span> <span class="ot">=</span> <span class="st">"latinx"</span>,</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"mexican/mexican american"</span> <span class="ot">=</span> <span class="st">"latinx"</span>,</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"not reported"</span> <span class="ot">=</span> <span class="st">"not_reported"</span>,</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">"other-2 or more"</span> <span class="ot">=</span> <span class="st">"multirace"</span>,</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">"other spanish/hispanic"</span> <span class="ot">=</span> <span class="st">"latinx"</span>,</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"puerto rican"</span> <span class="ot">=</span> <span class="st">"latinx"</span>,</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"white"</span> <span class="ot">=</span> <span class="st">"white"</span>          </span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>ethn_code)</span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">count</span>(ethn_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="factors" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="factors"><span class="header-section-number">4.1</span> Factors</h2>
<p><strong>Factors</strong> are an object <em>class</em> used to display categorical data (e.g., marital status)</p>
<ul>
<li>A factor is an <strong>augmented vector</strong> built by attaching a <strong>levels</strong> attribute to an (atomic) integer vectors</li>
</ul>
<p>Usually, we would prefer a categorical variable (e.g., race, school type) to be a factor variable rather than a character variable</p>
<ul>
<li>So far in the course I have made all categorical variables character variables because we have not introduced factors yet</li>
</ul>
<p><strong>Create factor version of character variable <code>ethn_code</code> using base R <code>factor()</code> function</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>ethn_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:268396] "multirace" "white" "white" "multirace" "white" "multirace" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wwlist<span class="sc">$</span>ethn_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create factor var; tidyverse approach</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>wwlist <span class="ot">&lt;-</span> wwlist <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ethn_code_fac =</span> <span class="fu">factor</span>(ethn_code)) </span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co">#wwlist$ethn_code_fac &lt;- factor(wwlist$ethn_code) # base r approach</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>ethn_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:268396] "multirace" "white" "white" "multirace" "white" "multirace" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>ethn_code_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 7 levels "api","black",..: 4 7 7 4 7 4 4 4 4 7 ...</code></pre>
</div>
</div>
<p><strong>Character variable <code>ethn_code</code></strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(wwlist<span class="sc">$</span>ethn_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wwlist<span class="sc">$</span>ethn_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist<span class="sc">$</span>ethn_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>ethn_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:268396] "multirace" "white" "white" "multirace" "white" "multirace" ...</code></pre>
</div>
</div>
<p><strong>Factor variable <code>ethn_code_fac</code></strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(wwlist<span class="sc">$</span>ethn_code_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wwlist<span class="sc">$</span>ethn_code_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist<span class="sc">$</span>ethn_code_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$levels
[1] "api"          "black"        "latinx"       "multirace"    "nativeam"    
[6] "not_reported" "white"       

$class
[1] "factor"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>ethn_code_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 7 levels "api","black",..: 4 7 7 4 7 4 4 4 4 7 ...</code></pre>
</div>
</div>
</section>
<section id="working-with-factor-variables" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="working-with-factor-variables"><span class="header-section-number">4.2</span> Working with factor variables</h2>
<p>Main things to note about variable <code>ethn_code_fac</code></p>
<ul>
<li><strong>type</strong> = integer</li>
<li><strong>class</strong> = factor, because the variable has a <strong>levels</strong> attribute</li>
<li>Underlying data are integers, but the values of the <strong>levels</strong> attribute is what’s displayed:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print first few obs of ethn_code_fac</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>wwlist<span class="sc">$</span>ethn_code_fac[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] multirace white     white     multirace white    
Levels: api black latinx multirace nativeam not_reported white</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print count for each category in ethn_code_fac</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">count</span>(ethn_code_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  ethn_code_fac      n
  &lt;fct&gt;          &lt;int&gt;
1 api             2385
2 black            563
3 latinx          9245
4 multirace      90584
5 nativeam         202
6 not_reported    5737
7 white         159680</code></pre>
</div>
</div>
<p>Apply <code>as.integer()</code> to display underlying integer values of factor the variable</p>
<p>Investigate <code>as.integer()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(wwlist<span class="sc">$</span>ethn_code_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wwlist<span class="sc">$</span>ethn_code_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">as.integer</span>(wwlist<span class="sc">$</span>ethn_code_fac))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">as.integer</span>(wwlist<span class="sc">$</span>ethn_code_fac))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
<p>Display underlying integer values of variable <code>ethn_code_fac</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">count</span>(<span class="fu">as.integer</span>(ethn_code_fac))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  `as.integer(ethn_code_fac)`      n
                        &lt;int&gt;  &lt;int&gt;
1                           1   2385
2                           2    563
3                           3   9245
4                           4  90584
5                           5    202
6                           6   5737
7                           7 159680</code></pre>
</div>
</div>
<p>Refer to categories of a factor (e.g., when filtering obs) using values of <strong>levels</strong> attribute rather than underlying values of variable</p>
<ul>
<li>Values of <strong>levels</strong> attribute for <code>ethn_code_fac</code> (output omitted)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist<span class="sc">$</span>ethn_code_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Example</strong>: Count the number of prospects in <code>wwlist</code> who identify as “white”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># referring to variable value; this doesn't work</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ethn_code_fac<span class="sc">==</span><span class="dv">7</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1     0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co">#referring to value of level attribute; this works</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ethn_code_fac<span class="sc">==</span><span class="st">"white"</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
       n
   &lt;int&gt;
1 159680</code></pre>
</div>
</div>
<p><strong>Example</strong>: Count the number of prospects in <code>wwlist</code> who identify as “white”</p>
<ul>
<li>To refer to underlying integer values, apply <code>as.integer()</code> function to factor variable</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist<span class="sc">$</span>ethn_code_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$levels
[1] "api"          "black"        "latinx"       "multirace"    "nativeam"    
[6] "not_reported" "white"       

$class
[1] "factor"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">as.integer</span>(ethn_code_fac)<span class="sc">==</span><span class="dv">7</span>) <span class="sc">%&gt;%</span> count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
       n
   &lt;int&gt;
1 159680</code></pre>
</div>
</div>
</section>
<section id="how-to-identify-the-variable-values-associated-with-factor-levels" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="how-to-identify-the-variable-values-associated-with-factor-levels"><span class="header-section-number">4.3</span> How to identify the variable values associated with factor levels</h2>
<p>Create a factor version of the character variable <code>psat_range</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">count</span>(psat_range)</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>wwlist <span class="ot">&lt;-</span> wwlist <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">psat_range_fac =</span> <span class="fu">factor</span>(psat_range))</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">count</span>(psat_range_fac)</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist<span class="sc">$</span>psat_range_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Investigate values associated with factor levels using <code>levels()</code> and <code>nlevels()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(wwlist<span class="sc">$</span>psat_range_fac) <span class="co">#starts at 1</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nlevels</span>(wwlist<span class="sc">$</span>psat_range_fac) <span class="co">#7 levels total</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(wwlist<span class="sc">$</span>psat_range_fac)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="co">#prints levels 1-3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once values associated with factor levels are known:</p>
<ul>
<li>Can filter based on underlying integer values using <code>as.integer()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">as.integer</span>(psat_range_fac)<span class="sc">==</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1  8348</code></pre>
</div>
</div>
<ul>
<li>Or filter based on value of factor <strong>levels</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">filter</span>(psat_range<span class="sc">==</span><span class="st">"1270-1520"</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1  8348</code></pre>
</div>
</div>
<section id="student-exercise-working-with-factors" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="student-exercise-working-with-factors"><span class="header-section-number">4.3.1</span> Student exercise working with factors</h3>
<ol type="1">
<li>After running the code below, use <code>typeof()</code>, <code>class()</code>, <code>str()</code>, and <code>attributes()</code> functions to check the new variable <code>receive_year</code><br>
</li>
<li>Create a factor variable from the input variable <code>receive_year</code> and name it <code>receive_year_fac</code><br>
</li>
<li>Run the same functions (<code>typeof()</code>, <code>class()</code>, etc.) from the first question using the new variable you created<br>
</li>
<li>Get a count of <code>receive_year_fac</code>. (<strong>hint:</strong> you could also run this in the console to see values associated with each factor)</li>
</ol>
<p>Run this code to create a year variable from the input variable <code>receive_date</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wwlist %&gt;% glimpse()</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># load library if you haven't already</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>wwlist <span class="ot">&lt;-</span> wwlist <span class="sc">%&gt;%</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">receive_year =</span> <span class="fu">year</span>(receive_date)) <span class="co"># create year variable with lubridate</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check variable</span></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> </span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(receive_year)</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(receive_year) <span class="sc">%&gt;%</span> </span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(receive_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<summary>
<strong>Solutions to student exercise working with factors <code>%&gt;%</code></strong>
</summary>
<ol type="1">
<li>After running the code below, use <code>typeof()</code>, <code>class()</code>, <code>str()</code>, and <code>attributes()</code> functions to check the new variable <code>receive_year</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(wwlist<span class="sc">$</span>receive_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wwlist<span class="sc">$</span>receive_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>receive_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:268396] 2016 2016 2016 2016 2016 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist<span class="sc">$</span>receive_year) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Create a factor variable from the input variable <code>receive_year</code> and name it <code>receive_year_fac</code><br>
</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create factor var; tidyverse approach</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>wwlist <span class="ot">&lt;-</span> wwlist <span class="sc">%&gt;%</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">receive_year_fac =</span> <span class="fu">factor</span>(receive_year))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Run the same functions (<code>typeof()</code>, <code>class()</code>, etc.) from the first question using the new variable you created<br>
</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(wwlist<span class="sc">$</span>receive_year_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wwlist<span class="sc">$</span>receive_year_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>receive_year_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 3 levels "2016","2017",..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist<span class="sc">$</span>receive_year_fac)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$levels
[1] "2016" "2017" "2018"

$class
[1] "factor"</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Get a count of <code>receive_year_fac</code>. (<strong>hint:</strong> you could also run this in the console to see values associated with each factor)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(receive_year_fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  receive_year_fac     n
  &lt;fct&gt;            &lt;int&gt;
1 2016             89637
2 2017             89816
3 2018             88943</code></pre>
</div>
</div>
</details>
<p><br></p>
</section>
</section>
</section>
<section id="class-labelled" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Class == labelled</h1>
<section id="data-we-will-use-to-introduce-labelled-class" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="data-we-will-use-to-introduce-labelled-class"><span class="header-section-number">5.1</span> Data we will use to introduce <code>labelled</code> class</h2>
<p>High school longitudinal surveys from National Center for Education Statistics (NCES)</p>
<ul>
<li>Follow U.S. students from high school through college, labor market</li>
</ul>
<p>We will be working with <a href="https://nces.ed.gov/surveys/hsls09/index.asp">High School Longitudinal Study of 2009 (HSLS:09)</a></p>
<ul>
<li>Follows 9th graders from 2009</li>
<li>Data collection waves
<ul>
<li>Base Year (2009)</li>
<li>First Follow-up (2012)</li>
<li>2013 Update (2013)</li>
<li>High School Transcripts (2013-2014)</li>
<li>Second Follow-up (2016)</li>
</ul></li>
</ul>
</section>
<section id="using-haven-package-to-read-sasspssstata-datasets-into-r" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="using-haven-package-to-read-sasspssstata-datasets-into-r"><span class="header-section-number">5.2</span> Using <code>haven</code> package to read SAS/SPSS/Stata datasets into R</h2>
<p><a href="https://haven.tidyverse.org/"><code>haven</code></a>, which is part of <strong>tidyverse</strong>, “enables R to read and write various data formats” from the following statistical packages:</p>
<ul>
<li>SAS</li>
<li>SPSS</li>
<li>Stata</li>
</ul>
<p>If you haven’t installed <code>haven</code> run the following code in your console.</p>
<ul>
<li>Generic syntax: <code>install.packages("package_name")</code></li>
<li>Install “haven”: <code>install.packages("haven")</code></li>
</ul>
<p>Make sure to load <code>haven</code> (e.g., <code>library(haven)</code>)</p>
<p>When using <code>haven</code> to read data, resulting R objects have these characteristics:</p>
<ul>
<li>Data frames are <strong>tibbles</strong>, Tidyverse’s preferred <strong>class</strong> of data frames</li>
<li>Transform variables with “value labels” into the <code>labelled()</code> class
<ul>
<li><code>labelled</code> is an object class, just like <code>factor</code> is an object class</li>
<li><code>labelled</code> is an object <strong>class</strong> created by folks who created <code>haven</code> package</li>
<li><code>labelled</code> and <code>factor</code> classes are both viable alternatives for categorical variables</li>
<li>Helpful description of <code>labelled</code> class <a href="https://haven.tidyverse.org/articles/semantics.html">HERE</a></li>
</ul></li>
<li>Dates and times converted to R date/time classes</li>
<li>Character vectors not converted to factors</li>
</ul>
<p>Use <code>read_dta()</code> function from <code>haven</code> package to import Stata dataset into R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="st">"https://github.com/ozanj/rclass/raw/master/data/hsls/hsls_stu_small.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Must</strong> run this code chunk; permanently changes uppercase variable names to lowercase</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(hsls)</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(hsls) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">names</span>(hsls)) <span class="co"># convert names to lowercase</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(hsls) <span class="co"># names now lowercase</span></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hsls) <span class="co"># ugh</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Investigate variable <code>s3classes</code> from data frame <code>hsls</code></strong></p>
<ul>
<li>Identifies whether respondent taking postsecondary classes as of 11/1/2013</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(hsls<span class="sc">$</span>s3classes)</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(hsls<span class="sc">$</span>s3classes)</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hsls<span class="sc">$</span>s3classes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Investigate attributes of <code>s3classes</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(hsls<span class="sc">$</span>s3classes) <span class="co"># all attributes</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="co">#specific attributes: using syntax: attr(x, which, exact = FALSE)</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(<span class="at">x=</span>hsls<span class="sc">$</span>s3classes, <span class="at">which =</span> <span class="st">"label"</span>) <span class="co"># label attribute</span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(<span class="at">x=</span>hsls<span class="sc">$</span>s3classes, <span class="at">which =</span> <span class="st">"labels"</span>) <span class="co"># labels attribute</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-is-object-class-labelled" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="what-is-object-class-labelled"><span class="header-section-number">5.3</span> What is object class = <code>labelled</code>?</h2>
<p><strong>Variable labels</strong> are labels attached to a specific variable (e.g., marital status) <strong>Value labels</strong> [in Stata] are labels attached to specific values of a variable, e.g.:</p>
<ul>
<li>Var value <code>1</code> attached to value label “married”, <code>2</code>=“single”, <code>3</code>=“divorced”</li>
</ul>
<p><code>labelled</code> is object class for importing vars with <strong>value labels</strong> from SAS/SPSS/Stata</p>
<ul>
<li><code>labelled</code> object class created by <code>haven</code> package</li>
<li>Characteristics of variables in R data frame with <code>class==labelled</code>:
<ul>
<li>Data <code>type</code> can be numeric(double) or character</li>
<li>To see <code>value labels</code> associated with each value:
<ul>
<li><code>attr(df_name$var_name,"labels")</code></li>
<li>E.g., <code>attr(hsls$s3classes,"labels")</code></li>
</ul></li>
</ul></li>
</ul>
<p>Investigate the attributes of <code>hsls$s3classes</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(hsls<span class="sc">$</span>s3classes)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(hsls<span class="sc">$</span>s3classes)</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hsls<span class="sc">$</span>s3classes)</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(hsls<span class="sc">$</span>s3classes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code>attr(object_name,"attribute_name")</code> to refer to each attribute</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(hsls<span class="sc">$</span>s3classes,<span class="st">"label"</span>)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(hsls<span class="sc">$</span>s3classes,<span class="st">"format.stata"</span>)</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(hsls<span class="sc">$</span>s3classes,<span class="st">"class"</span>)</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(hsls<span class="sc">$</span>s3classes,<span class="st">"labels"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="labelled-package" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="labelled-package"><span class="header-section-number">5.4</span> <code>labelled</code> package</h2>
<p>Purpose of the <code>labelled</code> package is to work with data imported from SPSS/Stata/SAS using the <code>haven</code> package</p>
<ul>
<li><code>labelled</code> package contains functions to work with objects that have <code>labelled</code> class</li>
<li>From package documentation:
<ul>
<li>“purpose of the <code>labelled</code> package is to provide functions to manipulate <em>metadata</em> as variable labels, value labels and defined missing values using the <code>labelled</code> class and the <code>label</code> attribute introduced in <code>haven</code> package.”</li>
</ul></li>
<li>More info on the <code>labelled</code> package: <a href="https://cran.r-project.org/web/packages/labelled/vignettes/intro_labelled.html">LINK</a></li>
</ul>
<p>Functions in <code>labelled</code> package</p>
<ul>
<li><a href="https://www.rdocumentation.org/packages/labelled/versions/1.1.0">Full list</a></li>
</ul>
</section>
<section id="get-variable-and-value-labels" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="get-variable-and-value-labels"><span class="header-section-number">5.5</span> Get variable and value labels</h2>
<p><strong>Get variable labels</strong> using <code>var_label()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">select</span>(s3classes) <span class="sc">%&gt;%</span> <span class="fu">var_label</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$s3classes
[1] "S3 B01A Taking postsecondary classes as of Nov 1 2013"</code></pre>
</div>
</div>
<p><strong>Get value labels</strong> using <code>val_labels()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">select</span>(s3classes) <span class="sc">%&gt;%</span> <span class="fu">val_labels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$s3classes
                                     Missing 
                                          -9 
                           Unit non-response 
                                          -8 
                     Item legitimate skip/NA 
                                          -7 
                    Component not applicable 
                                          -6 
Item not administered: abbreviated interview 
                                          -4 
                                         Yes 
                                           1 
                                          No 
                                           2 
                                  Don't know 
                                           3 </code></pre>
</div>
</div>
</section>
<section id="working-with-labelled-class-data" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="working-with-labelled-class-data"><span class="header-section-number">5.6</span> Working with <code>labelled</code> class data</h2>
<p>Create frequency tables with <code>labelled</code> class variables using <code>count()</code></p>
<ul>
<li>Default setting is to show variable <strong>values</strong> not <strong>value labels</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">count</span>(s3classes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  s3classes                  n
  &lt;dbl+lbl&gt;              &lt;int&gt;
1 -9 [Missing]              59
2 -8 [Unit non-response]  4945
3  1 [Yes]               13477
4  2 [No]                 3401
5  3 [Don't know]         1621</code></pre>
</div>
</div>
<p>To make frequency table show <strong>value labels</strong> add <code>%&gt;% as_factor()</code> to pipe</p>
<ul>
<li><code>as_factor()</code> is function from <code>haven</code> that converts an object to a factor</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">count</span>(s3classes) <span class="sc">%&gt;%</span> <span class="fu">as_factor</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  s3classes             n
  &lt;fct&gt;             &lt;int&gt;
1 Missing              59
2 Unit non-response  4945
3 Yes               13477
4 No                 3401
5 Don't know         1621</code></pre>
</div>
</div>
<p>To isolate values of <code>labelled</code> class variables in <code>filter()</code> function:</p>
<ul>
<li>Refer to variable <strong>value</strong>, not the <strong>value label</strong></li>
</ul>
<p><strong>Task</strong></p>
<ul>
<li>How many observations in var <code>s3classes</code> associated with “Unit non-response”</li>
<li>How many observations in var <code>s3classes</code> associated with “Yes”</li>
</ul>
<p>General steps to follow:</p>
<ol type="1">
<li>Investigate object</li>
<li>Use <code>filter()</code> to isolate desired observations</li>
</ol>
<p>Investigate object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(hsls<span class="sc">$</span>s3classes)</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">select</span>(s3classes) <span class="sc">%&gt;%</span> <span class="fu">var_label</span>() <span class="co">#show variable label</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">select</span>(s3classes) <span class="sc">%&gt;%</span> <span class="fu">val_labels</span>() <span class="co">#show value label</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">count</span>(s3classes) <span class="co"># freq table, values</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">count</span>(s3classes) <span class="sc">%&gt;%</span> <span class="fu">as_factor</span>() <span class="co"># freq table, value labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Filter specific values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">filter</span>(s3classes<span class="sc">==-</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="co"># -8 = unit non-response</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">filter</span>(s3classes<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="co"># 1 = yes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-variable-and-value-labels" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="set-variable-and-value-labels"><span class="header-section-number">5.7</span> Set variable and value labels</h2>
<p><strong>Set variable labels</strong> using <code>var_label()</code> or <code>set_variable_labels()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set one variable label</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_name<span class="sc">$</span>var_name) <span class="ot">&lt;-</span> <span class="st">'variable label'</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set multiple variable labels</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>df_name <span class="ot">&lt;-</span> df_name <span class="sc">%&gt;%</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_variable_labels</span>(</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">var_name_1 =</span> <span class="st">'variable label 1'</span>,</span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">var_name_2 =</span> <span class="st">'variable label 2'</span>,</span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">var_name_3 =</span> <span class="st">'variable label 3'</span></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Set value labels</strong> using <code>val_label()</code> or <code>set_value_labels()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set one value label</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">val_label</span>(df_name<span class="sc">$</span>var_name, <span class="st">'variable_value'</span>) <span class="ot">&lt;-</span> <span class="st">'value_label'</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set multiple value labels</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>df_name <span class="ot">&lt;-</span> df_name <span class="sc">%&gt;%</span></span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_value_labels</span>(</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">var_name_1 =</span> <span class="fu">c</span>(<span class="st">'value_label_1'</span> <span class="ot">=</span> <span class="st">'variable_value_1'</span>,</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'value_label_2'</span> <span class="ot">=</span> <span class="st">'variable_value_2'</span>,</span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">var_name_2 =</span> <span class="fu">c</span>(<span class="st">'value_label_3'</span> <span class="ot">=</span> <span class="st">'variable_value_3'</span>,</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'value_label_4'</span> <span class="ot">=</span> <span class="st">'variable_value_4'</span>)</span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="create-example-data-frame" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="create-example-data-frame"><span class="header-section-number">5.7.1</span> Create example data frame</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>id, <span class="sc">~</span>edu, <span class="sc">~</span>sch,</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#--|--|----</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>,</span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>,</span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">2</span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
     id   edu   sch
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1     2     2
2     2     1     1
3     3     3     2
4     4     4     2
5     5     1     2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [5 × 3] (S3: tbl_df/tbl/data.frame)
 $ id : num [1:5] 1 2 3 4 5
 $ edu: num [1:5] 2 1 3 4 1
 $ sch: num [1:5] 2 1 2 2 2</code></pre>
</div>
</div>
</section>
<section id="set-variable-labels" class="level3" data-number="5.7.2">
<h3 data-number="5.7.2" class="anchored" data-anchor-id="set-variable-labels"><span class="header-section-number">5.7.2</span> Set variable labels</h3>
<p>Use <code>set_variable_labels()</code> or <code>var_label()</code> to manually set variable labels</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df<span class="sc">$</span>sch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:5] 2 1 2 2 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>sch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using set_variable_labels()</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_variable_labels</span>(</span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="st">"Unique identification number"</span>,</span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">edu =</span> <span class="st">"Education level"</span></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Using var_label()</span></span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>sch) <span class="ot">&lt;-</span> <span class="st">'Type of school attending'</span></span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df<span class="sc">$</span>sch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:5] 2 1 2 2 2
 - attr(*, "label")= chr "Type of school attending"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>sch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Type of school attending"</code></pre>
</div>
</div>
</section>
<section id="set-value-labels" class="level3" data-number="5.7.3">
<h3 data-number="5.7.3" class="anchored" data-anchor-id="set-value-labels"><span class="header-section-number">5.7.3</span> Set value labels</h3>
<p>Use <code>set_value_labels()</code> or <code>val_label()</code> to manually set value labels</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">val_labels</span>(df<span class="sc">$</span>sch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using set_value_labels()</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_value_labels</span>(</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">edu =</span> <span class="fu">c</span>(<span class="st">'High School'</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">'AA degree'</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BA degree'</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">'MA or higher'</span> <span class="ot">=</span> <span class="dv">4</span>),</span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sch =</span> <span class="fu">c</span>(<span class="st">'Private'</span> <span class="ot">=</span> <span class="dv">1</span>))</span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Using val_label()</span></span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true" tabindex="-1"></a><span class="fu">val_label</span>(df<span class="sc">$</span>sch, <span class="dv">2</span>) <span class="ot">&lt;-</span> <span class="st">'Public'</span></span>
<span id="cb250-12"><a href="#cb250-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-13"><a href="#cb250-13" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df<span class="sc">$</span>sch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> dbl+lbl [1:5] 2, 1, 2, 2, 2
 @ labels: Named num [1:2] 1 2
  ..- attr(*, "names")= chr [1:2] "Private" "Public"
 @ label : chr "Type of school attending"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">val_labels</span>(df<span class="sc">$</span>sch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Private  Public 
      1       2 </code></pre>
</div>
</div>
</section>
<section id="view-the-set-variable-and-value-labels" class="level3" data-number="5.7.4">
<h3 data-number="5.7.4" class="anchored" data-anchor-id="view-the-set-variable-and-value-labels"><span class="header-section-number">5.7.4</span> View the set variable and value labels</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View variable and value labels using attributes()</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(df<span class="sc">$</span>sch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$labels
Private  Public 
      1       2 

$label
[1] "Type of school attending"

$class
[1] "haven_labelled" "vctrs_vctr"     "double"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View variable label</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>sch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Type of school attending"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(df<span class="sc">$</span>sch, <span class="st">'label'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Type of school attending"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View value labels</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">val_labels</span>(df<span class="sc">$</span>sch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Private  Public 
      1       2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(df<span class="sc">$</span>sch, <span class="st">'labels'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Private  Public 
      1       2 </code></pre>
</div>
</div>
</section>
<section id="labelled-student-exercise" class="level3" data-number="5.7.5">
<h3 data-number="5.7.5" class="anchored" data-anchor-id="labelled-student-exercise"><span class="header-section-number">5.7.5</span> <code>labelled</code> student exercise</h3>
<ol type="1">
<li>Get variable and value labels of the variable <code>s3hs</code> in the <code>hsls</code> data frame</li>
<li>Get a count of the variable <code>s3hs</code> showing the values and the value labels (<strong>hint</strong>: use <code>as_factor()</code>)</li>
<li>Get a count of the rows whose value for <code>s3hs</code> is associated with “Missing” (<strong>hint</strong>: use <code>filter()</code>)</li>
<li>Get a count of the rows whose value for <code>s3hs</code> is associated with “Missing” or “Unit non-response”</li>
<li>Add variable label for <code>pop_asian_zip</code> &amp; <code>pop_asian_state</code> in data frame <code>wwlist</code></li>
<li>Add value labels for <code>ethn_code</code> in data frame <code>wwlist</code></li>
</ol>
<details>
<summary>
<strong><code>labelled</code> student exercise solutions</strong>
</summary>
<ol type="1">
<li>Get variable and value labels of the variable <code>s3hs</code> in the <code>hsls</code> data frame</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> </span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(s3hs) <span class="sc">%&gt;%</span> </span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var_label</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$s3hs
[1] "S3 B01F Attending high school or homeschool as of Nov 1 2013"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> </span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(s3hs) <span class="sc">%&gt;%</span> </span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">val_labels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$s3hs
                                     Missing 
                                          -9 
                           Unit non-response 
                                          -8 
                     Item legitimate skip/NA 
                                          -7 
                    Component not applicable 
                                          -6 
Item not administered: abbreviated interview 
                                          -4 
                                         Yes 
                                           1 
                                          No 
                                           2 
                                  Don't know 
                                           3 </code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Get a count of the variable <code>s3hs</code> showing the values and the value labels (<strong>hint</strong>: use <code>as_factor()</code>)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> </span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(s3hs) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  s3hs                             n
  &lt;dbl+lbl&gt;                    &lt;int&gt;
1 -9 [Missing]                    22
2 -8 [Unit non-response]        4945
3 -7 [Item legitimate skip/NA] 16770
4  1 [Yes]                       624
5  2 [No]                        985
6  3 [Don't know]                157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> </span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(s3hs) <span class="sc">%&gt;%</span> </span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_factor</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  s3hs                        n
  &lt;fct&gt;                   &lt;int&gt;
1 Missing                    22
2 Unit non-response        4945
3 Item legitimate skip/NA 16770
4 Yes                       624
5 No                        985
6 Don't know                157</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Get a count of the rows whose value for <code>s3hs</code> is associated with “Missing” (<strong>hint</strong>: use <code>filter()</code>)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(s3hs<span class="sc">==</span> <span class="sc">-</span><span class="dv">9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    22</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Get a count of the rows whose value for <code>s3hs</code> is associated with “Missing” or “Unit non-response”</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(s3hs<span class="sc">==</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">|</span> s3hs<span class="sc">==</span> <span class="sc">-</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1  4967</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Add variable label for <code>pop_asian_zip</code> &amp; <code>pop_asian_state</code> in data frame <code>wwlist</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variable labels</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">select</span>(pop_asian_zip, pop_asian_state) <span class="sc">%&gt;%</span> <span class="fu">var_label</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$pop_asian_zip
NULL

$pop_asian_state
NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set variable labels</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>wwlist <span class="ot">&lt;-</span> wwlist <span class="sc">%&gt;%</span> </span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_variable_labels</span>(</span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_asian_zip =</span> <span class="st">"total asian population in zip"</span>,</span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_asian_state =</span><span class="st">"total asian population in state"</span></span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a><span class="co"># attribute of variable</span></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist<span class="sc">$</span>pop_asian_zip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$label
[1] "total asian population in zip"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist<span class="sc">$</span>pop_asian_state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$label
[1] "total asian population in state"</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>Add value labels for <code>ethn_code</code> in data frame <code>wwlist</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">count</span>(ethn_code)</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a><span class="co"># value labels</span></span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span> <span class="fu">select</span>(ethn_code) <span class="sc">%&gt;%</span> val_labels</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set value labels to ethn_code variable</span></span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>wwlist <span class="ot">&lt;-</span> wwlist <span class="sc">%&gt;%</span> </span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_value_labels</span>(</span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ethn_code =</span> <span class="fu">c</span>(<span class="st">"asian or native hawaiian or other pacific islander"</span> <span class="ot">=</span> <span class="st">"api"</span>,</span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"black or african american"</span> <span class="ot">=</span> <span class="st">"black"</span>,</span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"cuban or mexican/mexican american or other spanish/hispanic or puerto rican"</span> <span class="ot">=</span> <span class="st">"latinx"</span>,</span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"other-2 or more"</span> <span class="ot">=</span> <span class="st">"multirace"</span>,</span>
<span id="cb282-14"><a href="#cb282-14" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"american indian or alaska native"</span> <span class="ot">=</span> <span class="st">"nativeam"</span>,</span>
<span id="cb282-15"><a href="#cb282-15" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"not reported"</span> <span class="ot">=</span> <span class="st">"not_reported"</span>,</span>
<span id="cb282-16"><a href="#cb282-16" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"white"</span> <span class="ot">=</span> <span class="st">"white"</span></span>
<span id="cb282-17"><a href="#cb282-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb282-18"><a href="#cb282-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p><br></p>
</section>
</section>
</section>
<section id="comparing-class-labelled-to-class-factor" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Comparing class labelled to class factor</h1>
<table class="table">
<colgroup>
<col style="width: 43%">
<col style="width: 30%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><code>class==labelled</code></th>
<th><code>class==factor</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>data type</td>
<td>numeric or character</td>
<td>integer</td>
</tr>
<tr class="even">
<td>name of value label attribute</td>
<td>labels</td>
<td>levels</td>
</tr>
<tr class="odd">
<td>refer to data using</td>
<td>variable values</td>
<td>levels attribute</td>
</tr>
</tbody>
</table>
<p>So should you work with <code>class==labelled</code> or <code>class==factor</code>?</p>
<ul>
<li>No right or wrong answer; this is a subjective decision</li>
<li>Personally, I prefer <code>factor</code> class
<ul>
<li>Easier to run analysis (see section below)</li>
</ul></li>
<li><code>labelled</code> class
<ul>
<li>Feels more suited to working with survey data variables, where there are usually several different values that represent different kinds of “missing” values.</li>
</ul></li>
<li>You can use both! We recommend using labelled variables, particularly for exploratory data analysis, and factor variables for analysis when using categorical variables.</li>
</ul>
<section id="why-factor-variables-are-essential-for-analysis" class="level3" data-number="6.0.1">
<h3 data-number="6.0.1" class="anchored" data-anchor-id="why-factor-variables-are-essential-for-analysis"><span class="header-section-number">6.0.1</span> Why factor variables are essential for analysis</h3>
<p><br></p>
<p><strong>When running analyses using categorical variables (e.g., marital status: single, married, divorced, etc.), it is best practice to use <code>class == factor</code> over <code>class == labelled</code>.</strong></p>
<p>To demonstrate a quick example, let’s load data from ELS. We will use this data set later in the graphing and ggplot lecture, so don’t worry about understanding it now.</p>
<p>Say we are interested in the relationship between having an internship or co-op job (X) (in 2005-2006) on subsequent earnings (Y) (in 2011) after controlling for standardized reading test score (as a measure for high school achievement), sex, and race/ethnicity.</p>
<ul>
<li>We have two linear models below, the first using variables that are class labelled and the second using variables that are class factor.</li>
</ul>
<p><br></p>
<p><strong>Linear model <code>lm()</code> model using categorical variables of class <code>labelled</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>intern_mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> f3ern2011 <span class="sc">~</span> f2intern0506 <span class="sc">+</span> bytxrstd <span class="sc">+</span> f1sex <span class="sc">+</span> f1race_v2, <span class="at">data =</span> df_els_stu_allobs <span class="sc">%&gt;%</span> <span class="fu">filter</span>(f2enroll0506<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(intern_mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = f3ern2011 ~ f2intern0506 + bytxrstd + f1sex + f1race_v2, 
    data = df_els_stu_allobs %&gt;% filter(f2enroll0506 == 1))

Residuals:
   Min     1Q Median     3Q    Max 
-37135 -18595  -2783  12020 231894 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  20479.35    1607.58  12.739  &lt; 2e-16 ***
f2intern0506  5580.01    1059.32   5.268 1.41e-07 ***
bytxrstd       261.16      23.86  10.945  &lt; 2e-16 ***
f1sex        -4104.21     515.28  -7.965 1.85e-15 ***
f1race_v2    -1275.57     189.17  -6.743 1.64e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 24760 on 9317 degrees of freedom
  (21 observations deleted due to missingness)
Multiple R-squared:  0.02949,   Adjusted R-squared:  0.02908 
F-statistic: 70.78 on 4 and 9317 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><br></p>
<p><strong>Linear model <code>lm()</code> model using categorical variables of class <code>factor</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>intern_mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> f3ern2011 <span class="sc">~</span> f2intern0506 <span class="sc">+</span> bytxrstd <span class="sc">+</span> f1sex <span class="sc">+</span> f1race_v2, <span class="at">data =</span> df_els_stu_allobs_fac <span class="sc">%&gt;%</span> <span class="fu">filter</span>(f2enroll0506<span class="sc">==</span><span class="st">"yes"</span>))</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(intern_mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = f3ern2011 ~ f2intern0506 + bytxrstd + f1sex + f1race_v2, 
    data = df_els_stu_allobs_fac %&gt;% filter(f2enroll0506 == "yes"))

Residuals:
   Min     1Q Median     3Q    Max 
-37282 -18246  -2868  12045 228779 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      16503.51    1414.69  11.666  &lt; 2e-16 ***
f2intern0506yes   5616.95    1059.04   5.304 1.16e-07 ***
bytxrstd           240.60      24.38   9.869  &lt; 2e-16 ***
f1sexFemale      -4055.06     515.10  -7.872 3.87e-15 ***
f1race_v2api     -1784.73     817.78  -2.182  0.02910 *  
f1race_v2black   -5113.41     859.37  -5.950 2.78e-09 ***
f1race_v2latinx  -4768.47     838.71  -5.685 1.34e-08 ***
f1race_v2native -10149.40    3591.46  -2.826  0.00472 ** 
f1race_v2multi   -3206.89    1279.05  -2.507  0.01218 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 24740 on 9313 degrees of freedom
  (21 observations deleted due to missingness)
Multiple R-squared:  0.03148,   Adjusted R-squared:  0.03065 
F-statistic: 37.84 on 8 and 9313 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Why does this matter?</strong></p>
<p>Notice that for the linear model <code>intern_mod1</code>, the coefficients for categorical variables sex and race are grouped together, whereas in the second linear model <code>intern_mod2</code>, using class factor variables, coefficients are calculated separately by “category” (e.g., female, male, black, white, Asian, etc.).</p>
</section>
<section id="converting-classlabelled-to-classfactor" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="converting-classlabelled-to-classfactor"><span class="header-section-number">6.1</span> Converting <code>class==labelled</code> to <code>class==factor</code></h2>
<p>The <code>as_factor()</code> function from <code>haven</code> package converts variables with <code>class==labelled</code> to <code>class==factor</code></p>
<ul>
<li>Can be used for descriptive statistics</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">select</span>(s3classes) <span class="sc">%&gt;%</span> <span class="fu">count</span>(s3classes)</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>hsls <span class="sc">%&gt;%</span> <span class="fu">select</span>(s3classes) <span class="sc">%&gt;%</span> <span class="fu">count</span>(s3classes) <span class="sc">%&gt;%</span> <span class="fu">as_factor</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Can create object with some or all <code>labelled</code> vars converted to <code>factor</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>hsls_f <span class="ot">&lt;-</span> <span class="fu">as_factor</span>(hsls, <span class="at">only_labelled =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s examine this object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(hsls_f)</span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>hsls_f <span class="sc">%&gt;%</span> <span class="fu">select</span>(s3classes,s3clglvl) <span class="sc">%&gt;%</span> <span class="fu">str</span>()</span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(hsls_f<span class="sc">$</span>s3classes)</span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(hsls_f<span class="sc">$</span>s3classes)</span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(hsls_f<span class="sc">$</span>s3classes)</span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a>hsls_f <span class="sc">%&gt;%</span> <span class="fu">select</span>(s3classes) <span class="sc">%&gt;%</span> <span class="fu">var_label</span>()</span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a>hsls_f <span class="sc">%&gt;%</span> <span class="fu">select</span>(s3classes) <span class="sc">%&gt;%</span> <span class="fu">val_labels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="working-with-classfactor-data" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="working-with-classfactor-data"><span class="header-section-number">6.2</span> Working with <code>class==factor</code> data</h2>
<p>Showing factor levels associated with a factor variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>hsls_f <span class="sc">%&gt;%</span> <span class="fu">count</span>(s3classes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  s3classes             n
  &lt;fct&gt;             &lt;int&gt;
1 Missing              59
2 Unit non-response  4945
3 Yes               13477
4 No                 3401
5 Don't know         1621</code></pre>
</div>
</div>
<p>Showing variable values associated with a factor variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>hsls_f <span class="sc">%&gt;%</span> <span class="fu">count</span>(<span class="fu">as.integer</span>(s3classes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  `as.integer(s3classes)`     n
                    &lt;int&gt; &lt;int&gt;
1                       1    59
2                       2  4945
3                       6 13477
4                       7  3401
5                       8  1621</code></pre>
</div>
</div>
<p>When sub-setting observations (e.g., filtering), refer to the <code>level</code> attribute, not the underlying variable integer value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>hsls_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(s3classes<span class="sc">==</span><span class="st">"Yes"</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>(s3classes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  s3classes     n
  &lt;fct&gt;     &lt;int&gt;
1 Yes       13477</code></pre>
</div>
</div>
</section>
</section>
<section id="appendix-creating-factor-variables" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Appendix: Creating factor variables</h1>
<section id="create-factors-from-string-variables" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="create-factors-from-string-variables"><span class="header-section-number">7.1</span> Create factors [from string variables]</h2>
<p>To create a factor variable from string variable:</p>
<ol type="1">
<li>Create a character vector containing underlying data</li>
<li>Create a vector containing valid levels</li>
<li>Attach levels to the data using the <code>factor()</code> function</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Underlying data: months my fam is born</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Aug"</span>, <span class="st">"Apr"</span>, <span class="st">"Mar"</span>)</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create vector with valid levels</span></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>month_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>, </span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dec"</span>)</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Attach levels to data</span></span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1, <span class="at">levels =</span> month_levels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note how attributes differ:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:4] "Jan" "Aug" "Apr" "Mar"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 12 levels "Jan","Feb","Mar",..: 1 8 4 3</code></pre>
</div>
</div>
<p>Sorting also differs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(x1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Apr" "Aug" "Jan" "Mar"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Jan Mar Apr Aug
Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</code></pre>
</div>
</div>
<p>Let’s create a character version of variable <code>hs_state</code> and then turn it into a factor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co">#wwlist %&gt;%</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  count(hs_state)</span></span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset obs to West Coast states </span></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>wwlist_temp <span class="ot">&lt;-</span> wwlist <span class="sc">%&gt;%</span></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hs_state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CA"</span>, <span class="st">"OR"</span>, <span class="st">"WA"</span>))</span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create character version of high school state for West Coast states only</span></span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a>wwlist_temp<span class="sc">$</span>hs_state_char <span class="ot">&lt;-</span> <span class="fu">as.character</span>(wwlist_temp<span class="sc">$</span>hs_state)</span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Investigate character variable</span></span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist_temp<span class="sc">$</span>hs_state_char)</span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wwlist_temp<span class="sc">$</span>hs_state_char)</span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new variable that assigns levels</span></span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true" tabindex="-1"></a>wwlist_temp<span class="sc">$</span>hs_state_fac <span class="ot">&lt;-</span> <span class="fu">factor</span>(wwlist_temp<span class="sc">$</span>hs_state_char, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"CA"</span>,<span class="st">"OR"</span>,<span class="st">"WA"</span>))</span>
<span id="cb305-16"><a href="#cb305-16" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist_temp<span class="sc">$</span>hs_state_fac)</span>
<span id="cb305-17"><a href="#cb305-17" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(wwlist_temp<span class="sc">$</span>hs_state_fac)</span>
<span id="cb305-18"><a href="#cb305-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-19"><a href="#cb305-19" aria-hidden="true" tabindex="-1"></a><span class="co">#wwlist_temp %&gt;%</span></span>
<span id="cb305-20"><a href="#cb305-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  count(hs_state_fac)</span></span>
<span id="cb305-21"><a href="#cb305-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(wwlist_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>How the <code>levels</code> argument works when underlying data is character:</p>
<ul>
<li>Matches value of underlying data to value of the level attribute</li>
<li>Converts underlying data to integer, with level attribute attached</li>
</ul>
<p>See <a href="https://r4ds.had.co.nz/factors.html">Chapter 15 of Wickham</a> for more on factors (e.g., modifying factor order, modifying factor levels)</p>
</section>
<section id="creating-factors-from-integer-vectors" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="creating-factors-from-integer-vectors"><span class="header-section-number">7.2</span> Creating factors [from integer vectors]</h2>
<p>Factors are just integer vectors with level attributes attached to them. So, to create a factor:</p>
<ol type="1">
<li>Create a vector for the underlying data</li>
<li>Create a vector that has level attributes</li>
<li>Attach levels to the data using the <code>factor()</code> function</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>) <span class="co"># A vector of data</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"zero"</span>,<span class="st">"one"</span>) <span class="co"># A vector of labels</span></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Attach labels to values</span></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">&lt;-</span> <span class="fu">factor</span>(a1, <span class="at">labels =</span> a2)</span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>a3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] one  one  one  zero one  one  zero
Levels: zero one</code></pre>
</div>
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(a3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 2 levels "zero","one": 2 2 2 1 2 2 1</code></pre>
</div>
</div>
<p>Note: By default, <code>factor()</code> function attached “zero” to the lowest value of vector <code>a1</code> because “zero” was the first element of vector <code>a2</code></p>
<p>Let’s turn an integer variable into a factor variable in the <code>wwlist</code> data frame</p>
<p>Create integer version of <code>receive_year</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co">#typeof(wwlist_temp$receive_year)</span></span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>wwlist<span class="sc">$</span>receive_year_int <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(wwlist<span class="sc">$</span>receive_year)</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>receive_year_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> int [1:268396] 2016 2016 2016 2016 2016 2016 2016 2016 2016 2016 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(wwlist<span class="sc">$</span>receive_year_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
<p>Assign levels to values of integer variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>wwlist<span class="sc">$</span>receive_year_fac <span class="ot">&lt;-</span> <span class="fu">factor</span>(wwlist<span class="sc">$</span>receive_year_int, </span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Twenty-sixteen"</span>,<span class="st">"Twenty-seventeen"</span>,<span class="st">"Twenty-eighteen"</span>))</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>receive_year_fac)</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wwlist<span class="sc">$</span>receive_year)</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Check variable</span></span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span></span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(receive_year_fac)</span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a>wwlist <span class="sc">%&gt;%</span></span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(receive_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>